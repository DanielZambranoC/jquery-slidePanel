/**
* jQuery slidePanel
* a jquery slidePanel plugin
* Compiled: Wed Aug 31 2016 16:52:46 GMT+0800 (CST)
* @version v0.2.2
* @link https://github.com/amazingSurge/jquery-slidePanel
* @copyright LGPL-3.0
*/
!function(t,e){if("function"==typeof define&&define.amd)define(["jQuery"],e);else if("undefined"!=typeof exports)e(require("jQuery"));else{var n={exports:{}};e(t.jQuery),t.jquerySlidePanel=n.exports}}(this,function(t){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,n,i){function o(t,e){return 1-3*e+3*t}function s(t,e){return 3*e-6*t}function a(t){return 3*t}function r(t,e,n){return((o(e,n)*t+s(e,n))*t+a(e))*t}function l(t,e,n){return 3*o(e,n)*t*t+2*s(e,n)*t+a(e)}function u(e){for(var i=e,o=0;o<4;++o){var s=l(i,t,n);if(0===s)return i;var a=r(i,t,n)-e;i-=a/s}return i}return t===e&&n===i?{css:"linear",fn:function(t){return t}}:{css:"cubic-bezier("+t+","+e+","+n+","+i+")",fn:function(t){return r(u(t),e,i)}}}var o=e(t),s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=function(){return"undefined"!=typeof window.performance&&window.performance.now?window.performance.now():Date.now()},r=function(){function t(t,e){var s=!1,a=t.charAt(0).toUpperCase()+t.slice(1);return void 0!==i[t]&&(s=t),s||o.default.each(n,function(t,e){if(void 0!==i[e+a])return s="-"+e.toLowerCase()+"-"+a,!1}),e?s:!!s}function e(e){return t(e,!0)}var n=["webkit","Moz","O","ms"],i=(0,o.default)("<support>").get(0).style,s={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},a={csstransforms:function(){return Boolean(t("transform"))},csstransforms3d:function(){return Boolean(t("perspective"))},csstransitions:function(){return Boolean(t("transition"))},cssanimations:function(){return Boolean(t("animation"))}},r={};return a.csstransitions()&&(r.transition=new String(e("transition")),r.transition.end=s.transition.end[r.transition]),a.cssanimations()&&(r.animation=new String(e("animation")),r.animation.end=s.animation.end[r.animation]),a.csstransforms()&&(r.transform=new String(e("transform")),r.transform3d=a.csstransforms3d()),"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch?r.touch=!0:r.touch=!1,window.PointerEvent||window.MSPointerEvent?r.pointer=!0:r.pointer=!1,r.prefixPointerEvent=function(t){return window.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t},r}(),l={ease:i(.25,.1,.25,1),linear:i(0,0,1,1),"ease-in":i(.42,0,1,1),"ease-out":i(0,0,.58,1),"ease-in-out":i(.42,0,.58,1)},u={prepareTransition:function(t,e,n,i,s){var a=[];e&&a.push(e),n&&(o.default.isNumeric(n)&&(n+="ms"),a.push(n)),i?a.push(i):a.push(this.easing.css),s&&a.push(s),t.css(r.transition,a.join(" "))},do:function(t,e,n){m.enter("animating");var i=t.options.duration,s=t.options.easing||"ease",u=this,d=t.makePositionStyle(e),h=null;for(h in d)if({}.hasOwnProperty.call(d,h))break;t.options.useCssTransitions&&r.transition?(setTimeout(function(){u.prepareTransition(t.$panel,h,i,s)},20),t.$panel.one(r.transition.end,function(){o.default.isFunction(n)&&n(),t.$panel.css(r.transition,""),m.leave("animating")}),setTimeout(function(){t.setPosition(e)},20)):!function(){var i=a(),r=t.getPosition(),d=e,h=function e(a){var h=(a-i)/t.options.duration;h>1&&(h=1),h=l[s].fn(h);var c=parseFloat(r+h*(d-r),10);t.setPosition(c),1===h?(window.cancelAnimationFrame(u._frameId),u._frameId=null,o.default.isFunction(n)&&n(),m.leave("animating")):u._frameId=window.requestAnimationFrame(e)};u._frameId=window.requestAnimationFrame(h)}()}},d=function(){function t(e){n(this,t),this.initialize(e)}return s(t,[{key:"initialize",value:function(t){this._view=t,this.build()}},{key:"build",value:function(){if(!this._builded){var t=this._view.options,e=t.loading.template.call(this,t);switch(this.$el=(0,o.default)(e),t.loading.appendTo){case"panel":this.$el.appendTo(this._view.$panel);break;case"body":this.$el.appendTo("body");break;default:this.$el.appendTo(t.loading.appendTo)}this._builded=!0}}},{key:"show",value:function(t){this.build();var e=this._view.options;e.loading.showCallback.call(this,e),o.default.isFunction(t)&&t.call(this)}},{key:"hide",value:function(t){var e=this._view.options;e.loading.hideCallback.call(this,e),o.default.isFunction(t)&&t.call(this)}}]),t}(),h=function(){function t(){n(this,t)}return s(t,[{key:"initialize",value:function(t){this._view=t,this.options=t.options,this._drag={time:null,pointer:null},this.bindEvents()}},{key:"bindEvents",value:function(){var t=this._view.$panel,e=this.options;e.mouseDrag&&(t.on(m.eventName("mousedown"),o.default.proxy(this.onDragStart,this)),t.on(m.eventName("dragstart selectstart"),function(){if(!e.mouseDragHandler||(0,o.default)(event.target).is(e.mouseDragHandler)||(0,o.default)(event.target).parents(e.mouseDragHandler).length>0)return!1})),e.touchDrag&&r.touch&&(t.on(m.eventName("touchstart"),o.default.proxy(this.onDragStart,this)),t.on(m.eventName("touchcancel"),o.default.proxy(this.onDragEnd,this))),e.pointerDrag&&r.pointer&&(t.on(m.eventName(r.prefixPointerEvent("pointerdown")),o.default.proxy(this.onDragStart,this)),t.on(m.eventName(r.prefixPointerEvent("pointercancel")),o.default.proxy(this.onDragEnd,this)))}},{key:"onDragStart",value:function(t){var e=this;if(3!==t.which){var n=this.options;this._view.$panel.addClass(this.options.classes.dragging),this._position=this._view.getPosition(!0),this._drag.time=(new Date).getTime(),this._drag.pointer=this.pointer(t);var i=function(){m.enter("dragging"),m.trigger(e._view,"beforeDrag")};if(n.mouseDrag){if(n.mouseDragHandler&&!(0,o.default)(t.target).is(n.mouseDragHandler)&!((0,o.default)(t.target).parents(n.mouseDragHandler).length>0))return;(0,o.default)(document).on(m.eventName("mouseup"),o.default.proxy(this.onDragEnd,this)),(0,o.default)(document).one(m.eventName("mousemove"),o.default.proxy(function(){(0,o.default)(document).on(m.eventName("mousemove"),o.default.proxy(this.onDragMove,this)),i()},this))}n.touchDrag&&r.touch&&((0,o.default)(document).on(m.eventName("touchend"),o.default.proxy(this.onDragEnd,this)),(0,o.default)(document).one(m.eventName("touchmove"),o.default.proxy(function(){(0,o.default)(document).on(m.eventName("touchmove"),o.default.proxy(this.onDragMove,this)),i()},this))),n.pointerDrag&&r.pointer&&((0,o.default)(document).on(m.eventName(r.prefixPointerEvent("pointerup")),o.default.proxy(this.onDragEnd,this)),(0,o.default)(document).one(m.eventName(r.prefixPointerEvent("pointermove")),o.default.proxy(function(){(0,o.default)(document).on(m.eventName(r.prefixPointerEvent("pointermove")),o.default.proxy(this.onDragMove,this)),i()},this))),(0,o.default)(document).on(m.eventName("blur"),o.default.proxy(this.onDragEnd,this)),t.preventDefault()}}},{key:"onDragMove",value:function(t){var e=this.distance(this._drag.pointer,this.pointer(t));m.is("dragging")&&(Math.abs(e)>this.options.dragTolerance?this._willClose!==!0&&(this._willClose=!0,this._view.$panel.addClass(this.options.classes.willClose)):this._willClose!==!1&&(this._willClose=!1,this._view.$panel.removeClass(this.options.classes.willClose)),m.is("dragging")&&(t.preventDefault(),this.move(e)))}},{key:"onDragEnd",value:function(t){var e=this.distance(this._drag.pointer,this.pointer(t));(0,o.default)(document).off(m.eventName("mousemove mouseup touchmove touchend pointermove pointerup MSPointerMove MSPointerUp blur")),this._view.$panel.removeClass(this.options.classes.dragging),this._willClose===!0&&(this._willClose=!1,this._view.$panel.removeClass(this.options.classes.willClose)),m.is("dragging")&&(m.leave("dragging"),m.trigger(this._view,"afterDrag"),Math.abs(e)<this.options.dragTolerance?this._view.revert():m.hide())}},{key:"pointer",value:function(t){var e={x:null,y:null};return t=t.originalEvent||t||window.event,t=t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,t.pageX?(e.x=t.pageX,e.y=t.pageY):(e.x=t.clientX,e.y=t.clientY),e}},{key:"distance",value:function(t,e){var n=this.options.direction;return"left"===n||"right"===n?e.x-t.x:e.y-t.y}},{key:"move",value:function(t){var e=this._position+t;if("right"===this.options.direction||"bottom"===this.options.direction){if(e<0)return}else if(e>0)return;this.options.useCssTransforms||this.options.useCssTransforms3d||"right"!==this.options.direction&&"bottom"!==this.options.direction||(e=-e),this._view.setPosition(e+"px")}}]),t}(),c=function(t){return"string"==typeof t&&t.indexOf("%")!==-1},f=function(t){return"string"==typeof t&&t.indexOf("px")!==-1},p=function(t){return!(!t||"matrix"!==t.substr(0,6))&&t.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/)},g=function(){function t(e){n(this,t),this.initialize(e)}return s(t,[{key:"initialize",value:function(t){this.options=t,this._instance=null,this._showed=!1,this._isLoading=!1,this.build()}},{key:"setLength",value:function(){switch(this.options.direction){case"top":case"bottom":this._length=this.$panel.outerHeight();break;case"left":case"right":this._length=this.$panel.outerWidth()}}},{key:"build",value:function(){if(!this._builded){var t=this.options,e=t.template.call(this,t),n=this;this.$panel=(0,o.default)(e).appendTo("body"),t.skin&&this.$panel.addClass(t.skin),this.$content=this.$panel.find("."+this.options.classes.content),t.closeSelector&&this.$panel.on("click",t.closeSelector,function(){return n.hide(),!1}),this.loading=new d(this),this.setLength(),this.setPosition(this.getHidePosition()),(t.mouseDrag||t.touchDrag||t.pointerDrag)&&(this.drag=new h(this)),this._builded=!0}}},{key:"getHidePosition",value:function(){var t=this.options;if(t.useCssTransforms||t.useCssTransforms3d)switch(t.direction){case"top":case"left":return"-100";case"bottom":case"right":return"100"}switch(t.direction){case"top":case"bottom":return parseFloat(100*-(this._length/(0,o.default)(window).height()),10);case"left":case"right":return parseFloat(100*-(this._length/(0,o.default)(window).width()),10)}}},{key:"empty",value:function(){this._instance=null,this.$content.empty()}},{key:"load",value:function(t){function e(e){e=i.contentFilter.call(this,e,t),n.$content.html(e),n.hideLoading(),n._instance=t,m.trigger(n,"afterLoad",t)}var n=this,i=t.options;m.trigger(this,"beforeLoad",t),this.empty(),t.content?e(t.content):t.url?(this.showLoading(),o.default.ajax(t.url,t.settings||{}).done(function(t){e(t)})):e("")}},{key:"showLoading",value:function(){var t=this;this.loading.show(function(){t._isLoading=!0})}},{key:"hideLoading",value:function(){var t=this;this.loading.hide(function(){t._isLoading=!1})}},{key:"show",value:function(t){this.build(),m.enter("show"),m.trigger(this,"beforeShow"),(0,o.default)("html").addClass(this.options.classes.base+"-html"),this.$panel.addClass(this.options.classes.show);var e=this;u.do(this,0,function(){e._showed=!0,m.trigger(e,"afterShow"),o.default.isFunction(t)&&t.call(e)})}},{key:"change",value:function(t){m.trigger(this,"beforeShow"),m.trigger(this,"onChange",t,this._instance),this.load(t),m.trigger(this,"afterShow")}},{key:"revert",value:function(t){var e=this;u.do(this,0,function(){o.default.isFunction(t)&&t.call(e)})}},{key:"hide",value:function(t){m.leave("show"),m.trigger(this,"beforeHide");var e=this;u.do(this,this.getHidePosition(),function(){e.$panel.removeClass(e.options.classes.show),e._showed=!1,e._instance=null,m._current===e&&(m._current=null),m.is("show")||(0,o.default)("html").removeClass(e.options.classes.base+"-html"),o.default.isFunction(t)&&t.call(e),m.trigger(e,"afterHide")})}},{key:"makePositionStyle",value:function(t){var e=void 0,n="0",i="0";c(t)||f(t)||(t+="%"),this.options.useCssTransforms&&r.transform?("left"===this.options.direction||"right"===this.options.direction?n=t:i=t,e=r.transform.toString(),t=this.options.useCssTransforms3d&&r.transform3d?"translate3d("+n+","+i+",0)":"translate("+n+","+i+")"):e=this.options.direction;var o={};return o[e]=t,o}},{key:"getPosition",value:function(t){var e=void 0;if(this.options.useCssTransforms&&r.transform){if(e=p(this.$panel.css(r.transform)),!e)return 0;e="left"===this.options.direction||"right"===this.options.direction?e[12]||e[4]:e[13]||e[5]}else e=this.$panel.css(this.options.direction),e=parseFloat(e.replace("px",""));return t!==!0&&(e=e/this._length*100),parseFloat(e,10)}},{key:"setPosition",value:function(t){var e=this.makePositionStyle(t);this.$panel.css(e)}}]),t}(),v=function(t){"string"!=typeof t&&(t=JSON.stringify(t));var e=void 0,n=0,i=void 0,o=void 0;if(0===t.length)return n;for(i=0,o=t.length;i<o;i++)e=t.charCodeAt(i),n=(n<<5)-n+e,n|=0;return n},m={_states:{},_views:{},_current:null,is:function(t){return this._states[t]&&this._states[t]>0},enter:function(t){void 0===this._states[t]&&(this._states[t]=0),this._states[t]++},leave:function(t){this._states[t]--},trigger:function(t,e){for(var n=arguments.length,i=Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var a=[t].concat(i);(0,o.default)(document).trigger("slidePanel::"+e,a),o.default.isFunction(t.options[e])&&t.options[e](i)},eventName:function(t){if("string"!=typeof t||""===t)return".slidepanel";t=t.split(" ");for(var e=t.length,n=0;n<e;n++)t[n]=t[n]+".slidepanel";return t.join(" ")},show:function(t,e){if(!(t instanceof y))switch(arguments.length){case 0:t=new y;break;case 1:t=new y(t);break;case 2:t=new y(t,e)}var n=this.getView(t.options),i=this,o=function(){n.show(),n.load(t),i._current=n};null!==this._current?n===this._current?this._current.change(t):this._current.hide(o):o()},getView:function(t){var e=v(t);return this._views.hasOwnProperty(e)?this._views[e]:this._views[e]=new g(t)},hide:function(t){if(0!==t.length){var e=this.getView(t.options);e.hide()}else null!==this._current&&this._current.hide()}},w={options:{skin:null,classes:{base:"slidePanel",show:"slidePanel-show",loading:"slidePanel-loading",content:"slidePanel-content",dragging:"slidePanel-dragging",willClose:"slidePanel-will-close"},closeSelector:null,template:function(t){return'<div class="'+t.classes.base+" "+t.classes.base+"-"+t.direction+'"><div class="'+t.classes.content+'"></div></div>'},loading:{appendTo:"panel",template:function(t){return'<div class="'+t.classes.loading+'"></div>'},showCallback:function(t){this.$el.addClass(t.classes.loading+"-show")},hideCallback:function(t){this.$el.removeClass(t.classes.loading+"-show")}},contentFilter:function(t,e){return t},useCssTransforms3d:!0,useCssTransforms:!0,useCssTransitions:!0,dragTolerance:150,mouseDragHandler:null,mouseDrag:!0,touchDrag:!0,pointerDrag:!0,direction:"right",duration:"500",easing:"ease",beforeLoad:o.default.noop,afterLoad:o.default.noop,beforeShow:o.default.noop,afterShow:o.default.noop,onChange:o.default.noop,beforeChange:o.default.noop,beforeHide:o.default.noop,afterHide:o.default.noop,beforeDrag:o.default.noop,afterDrag:o.default.noop},is:function(t){return m.is(t)},show:function(t,e){return m.show(t,e),this},hide:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return m.hide(e),this}},y=function(){function t(e){n(this,t);for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];this.initialize.apply(this,[e].concat(o))}return s(t,[{key:"initialize",value:function(t){var e=(arguments.length<=1?void 0:arguments[1])||{};if("string"==typeof t)t={url:t};else if(t&&1===t.nodeType){var n=(0,o.default)(t);t={url:n.attr("href"),settings:n.data("settings")||{},options:n.data()||{}}}return t&&t.options?t.options=o.default.extend(!0,e,t.options):t.options=e,t.options=o.default.extend(!0,{},w.options,t.options),o.default.extend(this,t),this}}]),t}(),_=o.default.slidePanel=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];_.show.apply(this,e)};Date.now||(Date.now=function(){return(new Date).getTime()});for(var b=["webkit","moz"],k=0;k<b.length&&!window.requestAnimationFrame;++k){var C=b[k];window.requestAnimationFrame=window[C+"RequestAnimationFrame"],window.cancelAnimationFrame=window[C+"CancelAnimationFrame"]||window[C+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS (6|7|8)/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||!function(){var t=0;window.requestAnimationFrame=function(e){var n=a(),i=Math.max(t+16,n);return setTimeout(function(){e(t=i)},i-n)},window.cancelAnimationFrame=clearTimeout}(),_.options={skin:null,classes:{base:"slidePanel",show:"slidePanel-show",loading:"slidePanel-loading",content:"slidePanel-content",dragging:"slidePanel-dragging",willClose:"slidePanel-will-close"},closeSelector:null,template:function(t){return'<div class="'+t.classes.base+" "+t.classes.base+"-"+t.direction+'"><div class="'+t.classes.content+'"></div></div>'},loading:{appendTo:"panel",template:function(t){return'<div class="'+t.classes.loading+'"></div>'},showCallback:function(t){this.$el.addClass(t.classes.loading+"-show")},hideCallback:function(t){this.$el.removeClass(t.classes.loading+"-show")}},contentFilter:function(t,e){return t},useCssTransforms3d:!0,useCssTransforms:!0,useCssTransitions:!0,dragTolerance:150,mouseDragHandler:null,mouseDrag:!0,touchDrag:!0,pointerDrag:!0,direction:"right",duration:"500",easing:"ease",beforeLoad:o.default.noop,afterLoad:o.default.noop,beforeShow:o.default.noop,afterShow:o.default.noop,onChange:o.default.noop,beforeChange:o.default.noop,beforeHide:o.default.noop,afterHide:o.default.noop,beforeDrag:o.default.noop,afterDrag:o.default.noop},o.default.extend(_,{is:function(t){return m.is(t)},show:function(t,e){return m.show(t,e),this},hide:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return m.hide(e),this}}),o.default.fn.slidePanel=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var s=t;return"string"==typeof t?this.each(function(){var t=o.default.data(this,"slidePanel");switch(t instanceof y||(t=new y(this,n),o.default.data(this,"slidePanel",t)),s){case"hide":m.hide(t);break;case"show":m.show(t)}}):this.each(function(){o.default.data(this,"slidePanel")||(o.default.data(this,"slidePanel",new y(this,t)),(0,o.default)(this).on("click",function(t){var e=o.default.data(this,"slidePanel");m.show(e),t.preventDefault(),t.stopPropagation()}))})}});